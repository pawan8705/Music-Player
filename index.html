<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmony Music Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-gradient: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            --light-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f5576c;
            --success-color: #4cd964;
            --warning-color: #ffcc00;
            --danger-color: #ff4757;
            --text-dark: #ffffff;
            --text-light: #333333;
            --card-dark: rgba(255, 255, 255, 0.08);
            --card-light: rgba(255, 255, 255, 0.92);
            --shadow-dark: 0 20px 40px rgba(0, 0, 0, 0.5);
            --shadow-light: 0 15px 30px rgba(0, 0, 0, 0.1);
            --transition-slow: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --transition-medium: 0.3s ease;
            --transition-fast: 0.2s ease;
        }

        body {
            background: var(--dark-gradient);
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            transition: background var(--transition-slow);
            overflow-x: hidden;
        }

        body.light-theme {
            background: var(--light-gradient);
            color: var(--text-light);
        }

        /* Floating Music Notes Animation */
        .music-notes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .note {
            position: absolute;
            font-size: 2rem;
            opacity: 0.3;
            animation: floatNote 20s infinite linear;
        }

        @keyframes floatNote {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.3;
            }

            90% {
                opacity: 0.3;
            }

            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .music-player {
            width: 100%;
            max-width: 1200px;
            background: var(--card-dark);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: var(--shadow-dark);
            overflow: hidden;
            padding: 30px;
            transition: all var(--transition-slow);
            animation: slideUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideUp {
            0% {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .light-theme .music-player {
            background: var(--card-light);
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
            animation: fadeIn 1s ease 0.2s both;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
                transform: translateY(-20px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: var(--primary-gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
            animation: pulseLogo 3s infinite;
            position: relative;
            overflow: hidden;
        }

        @keyframes pulseLogo {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(to bottom right,
                    rgba(255, 255, 255, 0.3) 0%,
                    rgba(255, 255, 255, 0) 50%);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }

            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .logo-section h1 {
            font-size: 2.2rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-medium);
            position: relative;
            overflow: hidden;
        }

        .control-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .control-btn:hover::before {
            width: 100%;
            height: 100%;
        }

        .light-theme .control-btn {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .control-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .control-btn.active {
            background: var(--primary-gradient);
            color: white;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-color);
            color: white;
            font-size: 0.7rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounce 2s infinite;
            font-weight: bold;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
            animation: fadeIn 1s ease 0.4s both;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .player-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .album-art-container {
            position: relative;
            perspective: 1000px;
            cursor: pointer;
        }

        .album-art {
            width: 100%;
            max-width: 400px;
            height: 400px;
            margin: 0 auto;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
            position: relative;
            transform-style: preserve-3d;
            transition: transform var(--transition-medium);
        }

        .album-art:hover {
            transform: rotateY(10deg) rotateX(5deg) scale(1.03);
        }

        .album-art img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .album-art img.playing {
            animation: rotateAlbumArt 20s linear infinite;
        }

        @keyframes rotateAlbumArt {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .vinyl-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 60%, rgba(0, 0, 0, 0.7) 100%);
            border-radius: 20px;
            pointer-events: none;
        }

        .vinyl-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: #111;
            border-radius: 50%;
            border: 5px solid #222;
            z-index: 2;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
        }

        .vinyl-hole {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: #000;
            border-radius: 50%;
            z-index: 3;
        }

        .song-info {
            text-align: center;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            transition: all var(--transition-medium);
            animation: slideInLeft 0.8s ease 0.6s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideInLeft {
            0% {
                opacity: 0;
                transform: translateX(-30px);
            }

            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .song-info:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .song-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            line-height: 1.2;
            min-height: 2.8rem;
        }

        .song-artist {
            font-size: 1.4rem;
            color: #aaa;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .light-theme .song-artist {
            color: #666;
        }

        .song-album {
            font-size: 1.1rem;
            color: #888;
            margin-bottom: 15px;
        }

        .song-tags {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .song-tag {
            padding: 6px 15px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--primary-color);
            transition: all var(--transition-medium);
        }

        .song-tag:hover {
            transform: scale(1.1);
            background: rgba(102, 126, 234, 0.3);
        }

        .light-theme .song-tag {
            background: rgba(102, 126, 234, 0.1);
        }

        .progress-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            animation: slideInRight 0.8s ease 0.8s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideInRight {
            0% {
                opacity: 0;
                transform: translateX(30px);
            }

            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .progress-bar {
            height: 10px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .light-theme .progress-bar {
            background: rgba(0, 0, 0, 0.1);
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    rgba(102, 126, 234, 0.3) 0%,
                    rgba(118, 75, 162, 0.3) 50%,
                    rgba(102, 126, 234, 0.3) 100%);
            background-size: 200% 100%;
            animation: shimmer 3s infinite linear;
            border-radius: 10px;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .progress {
            height: 100%;
            width: 0%;
            background: var(--primary-gradient);
            border-radius: 10px;
            position: relative;
            z-index: 2;
            transition: width 0.1s linear;
        }

        .progress::after {
            content: '';
            position: absolute;
            height: 25px;
            width: 25px;
            border-radius: 50%;
            background: white;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
            transition: all var(--transition-fast);
            cursor: grab;
        }

        .progress:hover::after {
            transform: translateY(-50%) scale(1.2);
            box-shadow: 0 0 25px rgba(102, 126, 234, 0.9);
        }

        .timer {
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
            color: #aaa;
            margin-top: 10px;
        }

        .light-theme .timer {
            color: #666;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            animation: fadeIn 1s ease 1s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-medium);
            border-radius: 50%;
            position: relative;
        }

        .light-theme .player-btn {
            color: #333;
        }

        .player-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--primary-gradient);
            opacity: 0;
            z-index: -1;
            transition: opacity var(--transition-medium);
        }

        .player-btn:hover::after {
            opacity: 0.2;
        }

        .player-btn:hover {
            transform: translateY(-8px) scale(1.15);
        }

        .play-pause {
            width: 90px;
            height: 90px;
            background: var(--primary-gradient);
            font-size: 2.2rem;
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
            z-index: 1;
        }

        .play-pause:hover {
            transform: translateY(-8px) scale(1.15);
            box-shadow: 0 20px 45px rgba(102, 126, 234, 0.7);
        }

        .play-pause::after {
            display: none;
        }

        .play-pause::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border-radius: 50%;
            background: var(--primary-gradient);
            opacity: 0.3;
            z-index: -1;
            animation: pulseRing 2s infinite;
        }

        @keyframes pulseRing {
            0% {
                transform: scale(0.8);
                opacity: 0.3;
            }

            70% {
                transform: scale(1.1);
                opacity: 0.1;
            }

            100% {
                transform: scale(1.2);
                opacity: 0;
            }
        }

        .playlist-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .playlist-management {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            animation: slideInRight 0.8s ease 1.2s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .playlist-management h3 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fff;
        }

        .light-theme .playlist-management h3 {
            color: #333;
        }

        .management-actions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all var(--transition-medium);
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
        }

        .light-theme .action-btn {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .action-btn:hover {
            transform: translateY(-5px);
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .action-btn.delete {
            background: rgba(255, 71, 87, 0.2);
        }

        .action-btn.delete:hover {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
        }

        .action-btn.add {
            background: rgba(76, 217, 100, 0.2);
        }

        .action-btn.add:hover {
            background: linear-gradient(135deg, #4cd964 0%, #2ecc71 100%);
        }

        .current-playlist {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            flex: 1;
            display: flex;
            flex-direction: column;
            animation: slideInRight 0.8s ease 1.4s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-height: 450px;
        }

        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .playlist-header h3 {
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fff;
        }

        .light-theme .playlist-header h3 {
            color: #333;
        }

        .playlist-stats {
            display: flex;
            gap: 15px;
            color: #aaa;
            font-size: 0.9rem;
        }

        .light-theme .playlist-stats {
            color: #666;
        }

        .playlist-search {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px 18px;
            margin-bottom: 20px;
            transition: all var(--transition-medium);
        }

        .playlist-search:focus-within {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .playlist-search input {
            background: transparent;
            border: none;
            color: white;
            width: 100%;
            padding: 5px;
            font-size: 1rem;
        }

        .light-theme .playlist-search input {
            color: #333;
        }

        .playlist-search input:focus {
            outline: none;
        }

        .playlist-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 18px;
            border-radius: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all var(--transition-medium);
            background: rgba(255, 255, 255, 0.05);
            animation: fadeInUp 0.5s ease both;
            animation-delay: calc(var(--item-index) * 0.05s);
            position: relative;
            overflow: hidden;
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .playlist-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .playlist-item:hover::before {
            left: 100%;
        }

        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .light-theme .playlist-item {
            background: rgba(0, 0, 0, 0.05);
        }

        .light-theme .playlist-item:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .playlist-item.active {
            background: rgba(102, 126, 234, 0.3);
            border-left: 6px solid var(--primary-color);
            transform: translateX(10px);
        }

        .playlist-item img {
            width: 70px;
            height: 70px;
            border-radius: 12px;
            object-fit: cover;
            margin-right: 20px;
            transition: transform var(--transition-medium);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .playlist-item:hover img {
            transform: scale(1.1) rotate(5deg);
        }

        .playlist-song-info {
            flex: 1;
            min-width: 0;
        }

        .playlist-song-title {
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .play-count {
            background: var(--accent-color);
            color: white;
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 10px;
            animation: pulse 2s infinite;
        }

        .playlist-song-artist {
            font-size: 0.95rem;
            color: #aaa;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .light-theme .playlist-song-artist {
            color: #666;
        }

        .playlist-item-actions {
            display: flex;
            gap: 10px;
            opacity: 0;
            transition: opacity var(--transition-medium);
        }

        .playlist-item:hover .playlist-item-actions {
            opacity: 1;
        }

        .item-action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-medium);
        }

        .item-action-btn:hover {
            transform: scale(1.2);
        }

        .item-action-btn.delete {
            background: rgba(255, 71, 87, 0.2);
        }

        .item-action-btn.delete:hover {
            background: rgba(255, 71, 87, 0.8);
        }

        .item-action-btn.play {
            background: rgba(76, 217, 100, 0.2);
        }

        .item-action-btn.play:hover {
            background: rgba(76, 217, 100, 0.8);
        }

        .player-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            gap: 20px;
            animation: fadeIn 1s ease 1.6s both;
        }

        .light-theme .player-footer {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            min-width: 250px;
        }

        .volume-control i {
            color: #aaa;
            font-size: 1.4rem;
            transition: color var(--transition-medium);
        }

        .volume-control:hover i {
            color: var(--primary-color);
        }

        .light-theme .volume-control i {
            color: #666;
        }

        .volume-slider {
            flex: 1;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            position: relative;
        }

        .light-theme .volume-slider {
            background: rgba(0, 0, 0, 0.1);
        }

        .volume-percent {
            height: 100%;
            width: 70%;
            background: var(--primary-gradient);
            border-radius: 10px;
            position: relative;
            transition: width var(--transition-medium);
        }

        .volume-percent::after {
            content: '';
            position: absolute;
            height: 22px;
            width: 22px;
            border-radius: 50%;
            background: white;
            right: -11px;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
            opacity: 0;
            transition: opacity var(--transition-medium);
        }

        .volume-slider:hover .volume-percent::after {
            opacity: 1;
        }

        .player-stats {
            display: flex;
            gap: 25px;
            color: #aaa;
            font-size: 1rem;
        }

        .light-theme .player-stats {
            color: #666;
        }

        .player-stats div {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-controls {
            display: flex;
            gap: 15px;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-dark);
            border-radius: 25px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            backdrop-filter: blur(30px);
            box-shadow: var(--shadow-dark);
            animation: modalSlideUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes modalSlideUp {
            0% {
                opacity: 0;
                transform: translateY(60px) scale(0.9);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .light-theme .modal-content {
            background: var(--card-light);
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .modal-header h2 {
            font-size: 2rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-medium);
        }

        .light-theme .close-modal {
            color: #333;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(90deg);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #aaa;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .light-theme .form-group label {
            color: #666;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 18px 20px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 1.1rem;
            transition: all var(--transition-medium);
        }

        .light-theme .form-group input,
        .light-theme .form-group select {
            border: 2px solid rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.7);
            color: #333;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            transform: translateY(-3px);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 20px;
            margin-top: 40px;
        }

        .btn {
            padding: 18px 35px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all var(--transition-medium);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .light-theme .btn-secondary {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: var(--primary-gradient);
            color: white;
            padding: 20px 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 20px;
            transform: translateX(150%) scale(0.8);
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0) scale(1);
        }

        .toast-icon {
            font-size: 1.8rem;
        }

        .toast.success {
            background: linear-gradient(135deg, #4cd964 0%, #2ecc71 100%);
        }

        .toast.error {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
        }

        .toast.warning {
            background: linear-gradient(135deg, #ffcc00 0%, #f39c12 100%);
        }

        /* Confirmation dialog */
        .confirmation-dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1002;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .confirmation-dialog.active {
            display: flex;
        }

        .dialog-content {
            background: var(--card-dark);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            backdrop-filter: blur(30px);
            box-shadow: var(--shadow-dark);
            animation: modalSlideUp 0.5s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dialog-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--accent-color);
            animation: shake 0.5s ease;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px);
            }
        }

        .dialog-message {
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .dialog-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #aaa;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 1.2rem;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .light-theme ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 10px;
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .music-player {
                max-width: 95%;
                padding: 25px;
            }

            .album-art {
                max-width: 350px;
                height: 350px;
            }

            .playlist-song-title {
                font-size: 1rem;
            }
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .player-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-controls {
                width: 100%;
                justify-content: space-between;
            }

            .album-art {
                max-width: 320px;
                height: 320px;
            }

            .song-title {
                font-size: 1.8rem;
            }
        }

        .player-btn {
            width: 60px;
            height: 60px;
            font-size: 1.3rem;
        }

        .play-pause {
            width: 80px;
            height: 80px;
            font-size: 2rem;
        }

        .management-actions {
            grid-template-columns: 1fr 1fr;
        }

        @media (max-width: 768px) {
            .music-player {
                padding: 20px;
                border-radius: 20px;
            }

            .album-art {
                max-width: 280px;
                height: 280px;
            }

            .player-controls {
                gap: 15px;
            }

            .player-btn {
                width: 55px;
                height: 55px;
                font-size: 1.2rem;
            }

            .play-pause {
                width: 75px;
                height: 75px;
                font-size: 1.8rem;
            }

            .song-title {
                font-size: 1.6rem;
            }

            .song-artist {
                font-size: 1.1rem;
            }

            .playlist-management,
            .current-playlist {
                padding: 20px;
            }

            .playlist-item {
                padding: 15px;
            }

            .playlist-item img {
                width: 60px;
                height: 60px;
                margin-right: 15px;
            }

            .playlist-song-title {
                font-size: 0.95rem;
            }

            .playlist-song-artist {
                font-size: 0.85rem;
            }

            .player-footer {
                flex-direction: column;
                align-items: flex-start;
            }

            .volume-control {
                width: 100%;
            }

            .footer-controls {
                width: 100%;
                justify-content: space-between;
            }

            .toast {
                bottom: 20px;
                right: 20px;
                left: 20px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .music-player {
                padding: 15px;
                border-radius: 15px;
            }

            .album-art {
                max-width: 240px;
                height: 240px;
            }

            .song-title {
                font-size: 1.4rem;
            }

            .song-artist {
                font-size: 1rem;
            }

            .player-controls {
                padding: 20px;
            }

            .player-btn {
                width: 50px;
                height: 50px;
                font-size: 1.1rem;
            }

            .play-pause {
                width: 70px;
                height: 70px;
                font-size: 1.6rem;
            }

            .management-actions {
                grid-template-columns: 1fr;
            }

            .playlist-item {
                padding: 12px;
            }

            .playlist-item img {
                width: 50px;
                height: 50px;
                margin-right: 12px;
            }

            .playlist-item-actions {
                flex-direction: column;
                gap: 5px;
            }

            .item-action-btn {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }

            .modal-content {
                padding: 25px;
            }

            .btn {
                padding: 15px 25px;
                font-size: 1rem;
            }
        }

        /* Animation classes */
        .animated {
            animation-duration: 0.6s;
            animation-fill-mode: both;
        }

        .bounce-in {
            animation-name: bounceIn;
        }

        @keyframes bounceIn {

            0%,
            20%,
            40%,
            60%,
            80%,
            100% {
                animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }

            0% {
                opacity: 0;
                transform: scale3d(.3, .3, .3);
            }

            20% {
                transform: scale3d(1.1, 1.1, 1.1);
            }

            40% {
                transform: scale3d(.9, .9, .9);
            }

            60% {
                opacity: 1;
                transform: scale3d(1.03, 1.03, 1.03);
            }

            80% {
                transform: scale3d(.97, .97, .97);
            }

            100% {
                opacity: 1;
                transform: scale3d(1, 1, 1);
            }
        }

        .fade-out {
            animation: fadeOut 0.5s ease forwards;
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
                transform: translateY(0);
            }

            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        .slide-out-right {
            animation: slideOutRight 0.5s ease forwards;
        }

        @keyframes slideOutRight {
            0% {
                opacity: 1;
                transform: translateX(0);
            }

            100% {
                opacity: 0;
                transform: translateX(100px);
            }
        }

        /* Drag and drop */
        .playlist-item.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .playlist-item.drag-over {
            border: 2px dashed var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }
    </style>
</head>

<body>
    <!-- Floating Music Notes -->
    <div class="music-notes" id="musicNotes"></div>

    <!-- Music Player -->
    <div class="music-player" id="musicPlayer">
        <div class="player-header">
            <div class="logo-section">
                <div class="logo">
                    <i class="fas fa-music"></i>
                </div>
                <h1>Harmony Player</h1>
            </div>

            <div class="header-controls" id="headerControls">
                <button class="control-btn" id="themeToggle" title="Toggle Theme">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="control-btn" id="importPlaylistBtn" title="Import Playlist">
                    <i class="fas fa-file-import"></i>
                </button>
                <button class="control-btn" id="exportPlaylistBtn" title="Export Playlist">
                    <i class="fas fa-file-export"></i>
                </button>
                <button class="control-btn" id="sleepTimerBtn" title="Sleep Timer">
                    <i class="fas fa-bed"></i>
                </button>
                <button class="control-btn" id="downloadBtn" title="Download Current Song">
                    <i class="fas fa-download"></i>
                </button>
                <button class="control-btn" id="shareBtn" title="Share">
                    <i class="fas fa-share-alt"></i>
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="player-section">
                <div class="album-art-container" id="albumArtContainer">
                    <div class="album-art">
                        <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80"
                            alt="Album Art" id="albumArt">
                        <div class="vinyl-overlay"></div>
                        <div class="vinyl-center"></div>
                        <div class="vinyl-hole"></div>
                    </div>
                </div>

                <div class="song-info">
                    <h2 class="song-title" id="songTitle">Blinding Lights</h2>
                    <p class="song-artist" id="songArtist">The Weeknd</p>
                    <p class="song-album" id="songAlbum">After Hours • 2020 • Pop</p>

                    <div class="song-tags">
                        <span class="song-tag">#Synthwave</span>
                        <span class="song-tag">#80s</span>
                        <span class="song-tag">#ChartTopper</span>
                    </div>
                </div>

                <div class="progress-area">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div class="timer">
                        <span class="current-time" id="currentTime">0:00</span>
                        <span class="song-duration" id="songDuration">3:20</span>
                    </div>
                </div>

                <div class="player-controls">
                    <button class="player-btn" id="shuffleBtn" title="Shuffle">
                        <i class="fas fa-random"></i>
                    </button>
                    <button class="player-btn" id="prevBtn" title="Previous">
                        <i class="fas fa-step-backward"></i>
                    </button>

                    <button class="player-btn play-pause" id="playPauseBtn" title="Play/Pause">
                        <i class="fas fa-play" id="playPauseIcon"></i>
                    </button>

                    <button class="player-btn" id="nextBtn" title="Next">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <button class="player-btn" id="repeatBtn" title="Repeat">
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
            </div>

            <div class="playlist-section">
                <div class="playlist-management">
                    <h3><i class="fas fa-tasks"></i> Playlist Management</h3>
                    <div class="management-actions">
                        <button class="action-btn add" id="addSongBtn">
                            <i class="fas fa-plus-circle"></i>
                            Add Song
                        </button>
                        <button class="action-btn delete" id="createPlaylistBtn">
                            <i class="fas fa-list-alt"></i>
                            Create Playlist
                        </button>
                        <button class="action-btn" id="clearPlaylistBtn">
                            <i class="fas fa-trash-alt"></i>
                            Clear Playlist
                        </button>
                        <button class="action-btn delete" id="deletePlaylistBtn">
                            <i class="fas fa-trash"></i>
                            Delete Playlist
                        </button>
                    </div>

                    <div class="playlist-search">
                        <i class="fas fa-search"></i>
                        <input type="text" id="playlistSearch" placeholder="Search songs in playlist...">
                    </div>
                </div>

                <div class="current-playlist">
                    <div class="playlist-header">
                        <h3><i class="fas fa-list-music"></i> Current Playlist</h3>
                        <div class="playlist-stats">
                            <span id="totalSongs">5 songs</span>
                            <span id="totalDuration">15:40</span>
                        </div>
                    </div>

                    <div class="playlist-container" id="playlistContainer">
                        <!-- Playlist items will be added by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="player-footer">
            <div class="volume-control">
                <i class="fas fa-volume-down" id="volumeIcon"></i>
                <div class="volume-slider" id="volumeSlider">
                    <div class="volume-percent" id="volumePercent"></div>
                </div>
                <i class="fas fa-volume-up"></i>
            </div>

            <div class="player-stats">
                <div>
                    <i class="fas fa-play-circle"></i>
                    <span id="totalPlays">0 plays</span>
                </div>
                <div>
                    <i class="fas fa-clock"></i>
                    <span id="currentPlaytime">0:00</span>
                </div>
            </div>

            <div class="footer-controls">
                <button class="action-btn" id="fullScreenBtn">
                    <i class="fas fa-expand"></i>
                    Fullscreen
                </button>
            </div>
        </div>
    </div>

    <!-- Audio element -->
    <audio id="audioPlayer"></audio>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="toast-message" id="toastMessage">Song added to playlist!</div>
    </div>

    <!-- Add Song Modal -->
    <div class="modal" id="addSongModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Song</h2>
                <button class="close-modal" id="closeAddSongModal">&times;</button>
            </div>
            <form id="addSongForm">
                <div class="form-group">
                    <label for="songTitleInput">Song Title *</label>
                    <input type="text" id="songTitleInput" placeholder="Enter song title" required>
                </div>
                <div class="form-group">
                    <label for="artistInput">Artist *</label>
                    <input type="text" id="artistInput" placeholder="Enter artist name" required>
                </div>
                <div class="form-group">
                    <label for="albumInput">Album</label>
                    <input type="text" id="albumInput" placeholder="Enter album name">
                </div>
                <div class="form-group">
                    <label for="yearInput">Year</label>
                    <input type="number" id="yearInput" placeholder="2023" min="1900" max="2024">
                </div>
                <div class="form-group">
                    <label for="genreInput">Genre</label>
                    <select id="genreInput">
                        <option value="Pop">Pop</option>
                        <option value="Rock">Rock</option>
                        <option value="Hip Hop">Hip Hop</option>
                        <option value="Jazz">Jazz</option>
                        <option value="Classical">Classical</option>
                        <option value="Electronic">Electronic</option>
                        <option value="R&B">R&B</option>
                        <option value="Country">Country</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="durationInput">Duration (mm:ss) *</label>
                    <input type="text" id="durationInput" placeholder="3:20" required pattern="[0-9]+:[0-5][0-9]">
                </div>
                <div class="form-group">
                    <label for="coverUrlInput">Cover Image URL</label>
                    <input type="url" id="coverUrlInput" placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label for="audioUrlInput">Audio URL *</label>
                    <input type="url" id="audioUrlInput" placeholder="https://example.com/audio.mp3" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelAddSong">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus-circle"></i>
                        Add Song
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Playlist Modal -->
    <div class="modal" id="createPlaylistModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Playlist</h2>
                <button class="close-modal" id="closeCreatePlaylistModal">&times;</button>
            </div>
            <form id="createPlaylistForm">
                <div class="form-group">
                    <label for="playlistNameInput">Playlist Name *</label>
                    <input type="text" id="playlistNameInput" placeholder="My Awesome Playlist" required>
                </div>
                <div class="form-group">
                    <label for="playlistDescription">Description</label>
                    <input type="text" id="playlistDescription" placeholder="Describe your playlist...">
                </div>
                <div class="form-group">
                    <label for="playlistVisibility">Visibility</label>
                    <select id="playlistVisibility">
                        <option value="public">Public</option>
                        <option value="private" selected>Private</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCreatePlaylist">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus-circle"></i>
                        Create Playlist
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div class="confirmation-dialog" id="confirmationDialog">
        <div class="dialog-content">
            <div class="dialog-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="dialog-message" id="dialogMessage">
                Are you sure you want to delete this song?
            </div>
            <div class="dialog-actions">
                <button class="btn btn-secondary" id="dialogCancel">Cancel</button>
                <button class="btn btn-primary" id="dialogConfirm">
                    <i class="fas fa-trash"></i>
                    Delete
                </button>
            </div>
        </div>
    </div>
    <script>
        // Initialize music data
        let musicData = [
            {
                id: 1,
                title: "Blinding Lights",
                artist: "The Weeknd",
                album: "After Hours",
                year: "2020",
                genre: "Pop",
                src: "./assets/Song_4.mp3", //Add 1st music
                cover: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                duration: "3:20",
                tags: ["Synthwave", "80s", "ChartTopper"],
                playCount: 0,
                addedDate: "2024-01-15"
            },
            {
                id: 2,
                title: "Shape of You",
                artist: "Ed Sheeran",
                album: "÷ (Divide)",
                year: "2017",
                genre: "Pop",
                src: "./assets/Song_1.mp3", //Add 2nd music
                cover: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                duration: "3:53",
                tags: ["Pop", "Dance", "Love"],
                playCount: 0,
                addedDate: "2024-01-10"
            },
            {
                id: 3,
                title: "Bohemian Rhapsody",
                artist: "Queen",
                album: "A Night at the Opera",
                year: "1975",
                genre: "Rock",
                src: "./assets/Song_2.mp3", //Add 3rd music
                cover: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                duration: "5:55",
                tags: ["Classic", "Rock", "Epic"],
                playCount: 0,
                addedDate: "2024-01-05"
            },
            {
                id: 4,
                title: "Billie Jean",
                artist: "Michael Jackson",
                album: "Thriller",
                year: "1982",
                genre: "Pop",
                src: "./assets/Song_3.mp3", //Add 4th music
                cover: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                duration: "4:54",
                tags: ["80s", "Pop", "Dance"],
                playCount: 0,
                addedDate: "2024-01-01"
            },
            {
                id: 5,
                title: "Rolling in the Deep",
                artist: "Adele",
                album: "21",
                year: "2011",
                genre: "Pop",
                src: "./assets/Song_4.mp3",  //Add 5th music
                cover: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                duration: "3:48",
                tags: ["Soul", "Pop", "Powerful"],
                playCount: 0,
                addedDate: "2023-12-25"
            }
        ];

        // Playlists data
        let playlists = [
            {
                id: 1,
                name: "Favorites",
                description: "My favorite songs",
                visibility: "private",
                songs: [1, 2, 3],
                createdDate: "2024-01-01"
            },
            {
                id: 2,
                name: "Workout",
                description: "High energy songs for workout",
                visibility: "private",
                songs: [4, 5],
                createdDate: "2024-01-10"
            }
        ];

        // DOM Elements
        const audioPlayer = document.getElementById('audioPlayer');
        const albumArt = document.getElementById('albumArt');
        const songTitle = document.getElementById('songTitle');
        const songArtist = document.getElementById('songArtist');
        const songAlbum = document.getElementById('songAlbum');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playPauseIcon = document.getElementById('playPauseIcon');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const shuffleBtn = document.getElementById('shuffleBtn');
        const repeatBtn = document.getElementById('repeatBtn');
        const progressBar = document.getElementById('progressBar');
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTime');
        const songDurationEl = document.getElementById('songDuration');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumePercent = document.getElementById('volumePercent');
        const volumeIcon = document.getElementById('volumeIcon');
        const playlistContainer = document.getElementById('playlistContainer');
        const themeToggle = document.getElementById('themeToggle');
        const addSongBtn = document.getElementById('addSongBtn');
        const createPlaylistBtn = document.getElementById('createPlaylistBtn');
        const clearPlaylistBtn = document.getElementById('clearPlaylistBtn');
        const deletePlaylistBtn = document.getElementById('deletePlaylistBtn');
        const importPlaylistBtn = document.getElementById('importPlaylistBtn');
        const exportPlaylistBtn = document.getElementById('exportPlaylistBtn');
        const sleepTimerBtn = document.getElementById('sleepTimerBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const shareBtn = document.getElementById('shareBtn');
        const fullScreenBtn = document.getElementById('fullScreenBtn');
        const totalSongsEl = document.getElementById('totalSongs');
        const totalDurationEl = document.getElementById('totalDuration');
        const totalPlaysEl = document.getElementById('totalPlays');
        const currentPlaytimeEl = document.getElementById('currentPlaytime');
        const playlistSearch = document.getElementById('playlistSearch');
        const musicNotes = document.getElementById('musicNotes');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');

        // Modals
        const addSongModal = document.getElementById('addSongModal');
        const closeAddSongModal = document.getElementById('closeAddSongModal');
        const cancelAddSong = document.getElementById('cancelAddSong');
        const addSongForm = document.getElementById('addSongForm');

        const createPlaylistModal = document.getElementById('createPlaylistModal');
        const closeCreatePlaylistModal = document.getElementById('closeCreatePlaylistModal');
        const cancelCreatePlaylist = document.getElementById('cancelCreatePlaylist');
        const createPlaylistForm = document.getElementById('createPlaylistForm');

        const confirmationDialog = document.getElementById('confirmationDialog');
        const dialogMessage = document.getElementById('dialogMessage');
        const dialogCancel = document.getElementById('dialogCancel');
        const dialogConfirm = document.getElementById('dialogConfirm');

        // Player state
        let currentTrackIndex = 0;
        let isPlaying = false;
        let isShuffled = false;
        let isRepeating = false;
        let shuffleOrder = [];
        let sleepTimer = null;
        let totalPlayTime = 0;
        let playTimeInterval = null;
        let dragSrcEl = null;
        let itemToDelete = null;
        let deleteType = null; // 'song' or 'playlist'

        // Initialize player
        function initPlayer() {
            createMusicNotes();
            loadTrack(currentTrackIndex);
            renderPlaylist();
            updatePlaylistStats();
            updateTotalPlayTime();
            setupEventListeners();
            loadFromLocalStorage();

            // Start playtime counter
            playTimeInterval = setInterval(() => {
                if (isPlaying) {
                    totalPlayTime++;
                    updateTotalPlayTime();
                }
            }, 1000);

            showToast('Welcome to Harmony Player! 🎵', 'success');
        }

        // Create floating music notes
        function createMusicNotes() {
            const notes = ['♩', '♪', '♫', '♬', '♭', '♮', '♯'];

            for (let i = 0; i < 15; i++) {
                const note = document.createElement('div');
                note.className = 'note';
                note.textContent = notes[Math.floor(Math.random() * notes.length)];
                note.style.left = `${Math.random() * 100}%`;
                note.style.animationDelay = `${Math.random() * 20}s`;
                note.style.fontSize = `${Math.random() * 2 + 1.5}rem`;
                note.style.color = getRandomColor();
                musicNotes.appendChild(note);
            }
        }

        // Get random color for notes
        function getRandomColor() {
            const colors = [
                '#667eea', '#764ba2', '#f093fb', '#f5576c',
                '#4cd964', '#ffcc00', '#ff6b6b'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Audio player events
            audioPlayer.addEventListener('timeupdate', updateProgress);
            audioPlayer.addEventListener('ended', handleSongEnd);
            audioPlayer.addEventListener('play', () => {
                isPlaying = true;
                updatePlayPauseIcon();
                albumArt.classList.add('playing');
                updatePlayCount();
            });
            audioPlayer.addEventListener('pause', () => {
                isPlaying = false;
                updatePlayPauseIcon();
                albumArt.classList.remove('playing');
            });

            // Control buttons
            playPauseBtn.addEventListener('click', togglePlay);
            prevBtn.addEventListener('click', prevTrack);
            nextBtn.addEventListener('click', nextTrack);
            shuffleBtn.addEventListener('click', toggleShuffle);
            repeatBtn.addEventListener('click', toggleRepeat);

            // Progress bar
            progressBar.addEventListener('click', setProgress);

            // Volume control
            volumeSlider.addEventListener('click', setVolume);
            audioPlayer.volume = 0.7;
            updateVolumeSlider();

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);

            // Playlist management
            addSongBtn.addEventListener('click', () => showModal(addSongModal));
            createPlaylistBtn.addEventListener('click', () => showModal(createPlaylistModal));
            clearPlaylistBtn.addEventListener('click', confirmClearPlaylist);
            deletePlaylistBtn.addEventListener('click', showPlaylistDeleteOptions);
            importPlaylistBtn.addEventListener('click', importPlaylist);
            exportPlaylistBtn.addEventListener('click', exportPlaylist);

            // Song actions
            downloadBtn.addEventListener('click', downloadCurrentSong);
            shareBtn.addEventListener('click', shareCurrentSong);
            sleepTimerBtn.addEventListener('click', showSleepTimerOptions);

            // Fullscreen
            fullScreenBtn.addEventListener('click', toggleFullScreen);

            // Modal controls
            closeAddSongModal.addEventListener('click', () => hideModal(addSongModal));
            cancelAddSong.addEventListener('click', () => hideModal(addSongModal));
            closeCreatePlaylistModal.addEventListener('click', () => hideModal(createPlaylistModal));
            cancelCreatePlaylist.addEventListener('click', () => hideModal(createPlaylistModal));

            // Form submissions
            addSongForm.addEventListener('submit', addNewSong);
            createPlaylistForm.addEventListener('submit', createNewPlaylist);

            // Confirmation dialog
            dialogCancel.addEventListener('click', () => hideModal(confirmationDialog));
            dialogConfirm.addEventListener('click', confirmDelete);

            // Playlist search
            playlistSearch.addEventListener('input', filterPlaylist);

            // Album art click
            document.getElementById('albumArtContainer').addEventListener('click', togglePlay);

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);

            // Save on beforeunload
            window.addEventListener('beforeunload', saveToLocalStorage);
        }

        // Load a track
        function loadTrack(index) {
            const track = musicData[index];

            // Update audio source
            audioPlayer.src = track.src;

            // Update UI
            albumArt.src = track.cover;
            songTitle.textContent = track.title;
            songArtist.textContent = track.artist;
            songAlbum.textContent = `${track.album} • ${track.year} • ${track.genre}`;
            songDurationEl.textContent = track.duration;

            // Update tags
            const tagsContainer = document.querySelector('.song-tags');
            tagsContainer.innerHTML = '';
            track.tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'song-tag';
                tagElement.textContent = `#${tag}`;
                tagsContainer.appendChild(tagElement);
            });

            // Update active playlist item
            updateActivePlaylistItem(index);

            // Reset progress
            progress.style.width = '0%';
            currentTimeEl.textContent = '0:00';

            // If player was playing, play the new track
            if (isPlaying) {
                audioPlayer.play().catch(e => console.log("Autoplay prevented:", e));
            }

            // Save to localStorage
            saveToLocalStorage();
        }

        // Render playlist
        function renderPlaylist() {
            playlistContainer.innerHTML = '';

            if (musicData.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-music"></i>
                    <p>Your playlist is empty. Add some songs!</p>
                `;
                playlistContainer.appendChild(emptyState);
                return;
            }

            musicData.forEach((track, index) => {
                const playlistItem = document.createElement('div');
                playlistItem.className = `playlist-item ${index === currentTrackIndex ? 'active' : ''}`;
                playlistItem.dataset.index = index;
                playlistItem.dataset.id = track.id;
                playlistItem.style.setProperty('--item-index', index);
                playlistItem.draggable = true;

                playlistItem.innerHTML = `
                    <img src="${track.cover}" alt="${track.title}">
                    <div class="playlist-song-info">
                        <div class="playlist-song-title">
                            ${track.title}
                            ${track.playCount > 0 ? `<span class="play-count">${track.playCount}</span>` : ''}
                        </div>
                        <div class="playlist-song-artist">${track.artist} • ${track.album} • ${track.duration}</div>
                    </div>
                    <div class="playlist-item-actions">
                        <button class="item-action-btn play" title="Play Now">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="item-action-btn delete" title="Delete Song">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;

                // Play song
                playlistItem.addEventListener('click', (e) => {
                    if (!e.target.closest('.playlist-item-actions')) {
                        currentTrackIndex = index;
                        loadTrack(currentTrackIndex);
                        if (!isPlaying) {
                            togglePlay();
                        }
                    }
                });

                // Play button
                const playBtn = playlistItem.querySelector('.play');
                playBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentTrackIndex = index;
                    loadTrack(currentTrackIndex);
                    if (!isPlaying) {
                        togglePlay();
                    }
                });

                // Delete button
                const deleteBtn = playlistItem.querySelector('.delete');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showDeleteConfirmation('song', index, track.title);
                });

                // Drag and drop
                playlistItem.addEventListener('dragstart', handleDragStart);
                playlistItem.addEventListener('dragover', handleDragOver);
                playlistItem.addEventListener('drop', handleDrop);
                playlistItem.addEventListener('dragend', handleDragEnd);

                playlistContainer.appendChild(playlistItem);
            });

            // Add animation to items
            const items = document.querySelectorAll('.playlist-item');
            items.forEach((item, index) => {
                item.style.animationDelay = `${index * 0.05}s`;
            });
        }

        // Update active playlist item
        function updateActivePlaylistItem(index) {
            const playlistItems = document.querySelectorAll('.playlist-item');
            playlistItems.forEach(item => item.classList.remove('active'));

            if (playlistItems[index]) {
                playlistItems[index].classList.add('active');

                // Scroll to active item
                playlistItems[index].scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }
        }

        // Toggle play/pause
        function togglePlay() {
            if (isPlaying) {
                pauseTrack();
            } else {
                playTrack();
            }

            // Add animation
            playPauseBtn.classList.add('animated', 'bounce-in');
            setTimeout(() => {
                playPauseBtn.classList.remove('animated', 'bounce-in');
            }, 600);
        }

        // Play track
        function playTrack() {
            isPlaying = true;
            playPauseIcon.className = 'fas fa-pause';
            albumArt.classList.add('playing');
            audioPlayer.play().catch(e => console.log("Play failed:", e));
        }

        // Pause track
        function pauseTrack() {
            isPlaying = false;
            playPauseIcon.className = 'fas fa-play';
            albumArt.classList.remove('playing');
            audioPlayer.pause();
        }

        // Update play/pause icon
        function updatePlayPauseIcon() {
            playPauseIcon.className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
        }

        // Next track
        function nextTrack() {
            if (isShuffled && shuffleOrder.length > 0) {
                const currentShuffleIndex = shuffleOrder.indexOf(currentTrackIndex);
                if (currentShuffleIndex < shuffleOrder.length - 1) {
                    currentTrackIndex = shuffleOrder[currentShuffleIndex + 1];
                } else {
                    currentTrackIndex = shuffleOrder[0];
                }
            } else {
                currentTrackIndex = (currentTrackIndex + 1) % musicData.length;
            }

            loadTrack(currentTrackIndex);
            if (isPlaying) {
                playTrack();
            }

            // Add animation
            nextBtn.classList.add('animated', 'bounce-in');
            setTimeout(() => {
                nextBtn.classList.remove('animated', 'bounce-in');
            }, 600);
        }

        // Previous track
        function prevTrack() {
            if (audioPlayer.currentTime > 5) {
                // If more than 5 seconds have passed, restart current track
                audioPlayer.currentTime = 0;
            } else {
                // Otherwise, go to previous track
                if (isShuffled && shuffleOrder.length > 0) {
                    const currentShuffleIndex = shuffleOrder.indexOf(currentTrackIndex);
                    if (currentShuffleIndex > 0) {
                        currentTrackIndex = shuffleOrder[currentShuffleIndex - 1];
                    } else {
                        currentTrackIndex = shuffleOrder[shuffleOrder.length - 1];
                    }
                } else {
                    currentTrackIndex = (currentTrackIndex - 1 + musicData.length) % musicData.length;
                }

                loadTrack(currentTrackIndex);
                if (isPlaying) {
                    playTrack();
                }
            }

            // Add animation
            prevBtn.classList.add('animated', 'bounce-in');
            setTimeout(() => {
                prevBtn.classList.remove('animated', 'bounce-in');
            }, 600);
        }

        // Handle song end
        function handleSongEnd() {
            if (isRepeating) {
                // Repeat current song
                audioPlayer.currentTime = 0;
                audioPlayer.play();
            } else {
                // Play next song
                nextTrack();
            }
        }

        // Toggle shuffle
        function toggleShuffle() {
            isShuffled = !isShuffled;
            shuffleBtn.classList.toggle('active', isShuffled);

            if (isShuffled) {
                // Create shuffle order
                shuffleOrder = [...Array(musicData.length).keys()];
                for (let i = shuffleOrder.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffleOrder[i], shuffleOrder[j]] = [shuffleOrder[j], shuffleOrder[i]];
                }
                showToast('Shuffle mode activated', 'success');
            } else {
                shuffleOrder = [];
                showToast('Shuffle mode deactivated', 'info');
            }
        }

        // Toggle repeat
        function toggleRepeat() {
            isRepeating = !isRepeating;
            repeatBtn.classList.toggle('active', isRepeating);

            if (isRepeating) {
                showToast('Repeat mode activated', 'success');
            } else {
                showToast('Repeat mode deactivated', 'info');
            }
        }

        // Update progress bar
        function updateProgress() {
            const { currentTime, duration } = audioPlayer;

            if (duration) {
                const progressPercent = (currentTime / duration) * 100;
                progress.style.width = `${progressPercent}%`;

                // Update time display
                currentTimeEl.textContent = formatTime(currentTime);
            }
        }

        // Set progress on click
        function setProgress(e) {
            const width = this.clientWidth;
            const clickX = e.offsetX;
            const duration = audioPlayer.duration;

            audioPlayer.currentTime = (clickX / width) * duration;
        }

        // Set volume
        function setVolume(e) {
            const width = this.clientWidth;
            const clickX = e.offsetX;
            const volume = Math.min(1, Math.max(0, clickX / width));

            audioPlayer.volume = volume;
            updateVolumeSlider();
            updateVolumeIcon(volume);
        }

        // Update volume slider
        function updateVolumeSlider() {
            const volume = audioPlayer.volume;
            volumePercent.style.width = `${volume * 100}%`;
        }

        // Update volume icon
        function updateVolumeIcon(volume) {
            if (volume === 0) {
                volumeIcon.className = 'fas fa-volume-mute';
            } else if (volume < 0.5) {
                volumeIcon.className = 'fas fa-volume-down';
            } else {
                volumeIcon.className = 'fas fa-volume-up';
            }
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const icon = themeToggle.querySelector('i');
            if (document.body.classList.contains('light-theme')) {
                icon.className = 'fas fa-sun';
                showToast('Light theme activated', 'success');
            } else {
                icon.className = 'fas fa-moon';
                showToast('Dark theme activated', 'success');
            }

            saveToLocalStorage();
        }

        // Add new song
        function addNewSong(e) {
            e.preventDefault();

            const title = document.getElementById('songTitleInput').value;
            const artist = document.getElementById('artistInput').value;
            const album = document.getElementById('albumInput').value || "Unknown Album";
            const year = document.getElementById('yearInput').value || new Date().getFullYear().toString();
            const genre = document.getElementById('genreInput').value;
            const duration = document.getElementById('durationInput').value;
            const cover = document.getElementById('coverUrlInput').value || getRandomCoverImage();
            const audioUrl = document.getElementById('audioUrlInput').value;

            // Generate tags based on genre
            const tags = generateTags(genre);

            const newSong = {
                id: musicData.length > 0 ? Math.max(...musicData.map(s => s.id)) + 1 : 1,
                title,
                artist,
                album,
                year,
                genre,
                src: audioUrl,
                cover,
                duration,
                tags,
                playCount: 0,
                addedDate: new Date().toISOString().split('T')[0]
            };

            musicData.push(newSong);

            // Reset form
            addSongForm.reset();

            // Update UI
            renderPlaylist();
            updatePlaylistStats();

            // Hide modal
            hideModal(addSongModal);

            // Show success message
            showToast(`"${title}" has been added to your playlist!`, 'success');

            // Animate new item
            const newItem = document.querySelector(`.playlist-item[data-id="${newSong.id}"]`);
            if (newItem) {
                newItem.classList.add('animated', 'bounce-in');
                setTimeout(() => {
                    newItem.classList.remove('animated', 'bounce-in');
                }, 1000);
            }
        }

        // Get random cover image
        function getRandomCoverImage() {
            const covers = [
                'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80',
                'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80',
                'https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80',
                'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80',
                'https://images.unsplash.com/photo-1518609878373-06d740f60d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80'
            ];
            return covers[Math.floor(Math.random() * covers.length)];
        }

        // Generate tags based on genre
        function generateTags(genre) {
            const tagMap = {
                'Pop': ['Pop', 'Chart', 'Mainstream'],
                'Rock': ['Rock', 'Guitar', 'Energy'],
                'Hip Hop': ['Hip Hop', 'Rap', 'Urban'],
                'Jazz': ['Jazz', 'Smooth', 'Classic'],
                'Classical': ['Classical', 'Orchestra', 'Peaceful'],
                'Electronic': ['Electronic', 'EDM', 'Dance'],
                'R&B': ['R&B', 'Soul', 'Smooth'],
                'Country': ['Country', 'Acoustic', 'Storytelling']
            };
            return tagMap[genre] || [genre, 'Music', 'New'];
        }

        // Create new playlist
        function createNewPlaylist(e) {
            e.preventDefault();

            const name = document.getElementById('playlistNameInput').value;
            const description = document.getElementById('playlistDescription').value || "No description";
            const visibility = document.getElementById('playlistVisibility').value;

            const newPlaylist = {
                id: playlists.length > 0 ? Math.max(...playlists.map(p => p.id)) + 1 : 1,
                name,
                description,
                visibility,
                songs: [],
                createdDate: new Date().toISOString().split('T')[0]
            };

            playlists.push(newPlaylist);

            // Reset form
            createPlaylistForm.reset();

            // Hide modal
            hideModal(createPlaylistModal);

            // Show success message
            showToast(`Playlist "${name}" created!`, 'success');

            // Update UI if needed
            updatePlaylistStats();
        }

        // Show delete confirmation
        function showDeleteConfirmation(type, index, name) {
            deleteType = type;
            itemToDelete = index;

            if (type === 'song') {
                dialogMessage.textContent = `Are you sure you want to delete "${name}" from your playlist?`;
            } else {
                dialogMessage.textContent = `Are you sure you want to delete the playlist "${name}"?`;
            }

            showModal(confirmationDialog);
        }

        // Confirm delete
        function confirmDelete() {
            if (deleteType === 'song') {
                deleteSong(itemToDelete);
            } else {
                deletePlaylist(itemToDelete);
            }

            hideModal(confirmationDialog);
            itemToDelete = null;
            deleteType = null;
        }

        // Delete song
        function deleteSong(index) {
            const song = musicData[index];

            // Remove from all playlists first
            playlists.forEach(playlist => {
                playlist.songs = playlist.songs.filter(songId => songId !== song.id);
            });

            // Animate removal
            const item = document.querySelector(`.playlist-item[data-index="${index}"]`);
            if (item) {
                item.classList.add('fade-out');
                setTimeout(() => {
                    // Remove from music data
                    musicData.splice(index, 1);

                    // Update current track index if needed
                    if (currentTrackIndex >= index && currentTrackIndex > 0) {
                        currentTrackIndex--;
                    }

                    // If we deleted the current track, load the next one
                    if (index === currentTrackIndex) {
                        if (musicData.length > 0) {
                            currentTrackIndex = Math.min(currentTrackIndex, musicData.length - 1);
                            loadTrack(currentTrackIndex);
                        } else {
                            // No songs left
                            resetPlayer();
                        }
                    }

                    // Re-render playlist
                    renderPlaylist();
                    updatePlaylistStats();

                    showToast(`"${song.title}" removed from playlist`, 'success');
                }, 500);
            }
        }

        // Delete playlist
        function deletePlaylist(index) {
            const playlist = playlists[index];

            // Animate removal (in a real app, you'd have a playlist UI)
            playlists.splice(index, 1);
            showToast(`Playlist "${playlist.name}" deleted`, 'success');

            // Update UI if needed
            updatePlaylistStats();
        }

        // Confirm clear playlist
        function confirmClearPlaylist() {
            if (musicData.length === 0) {
                showToast('Playlist is already empty', 'warning');
                return;
            }

            dialogMessage.textContent = 'Are you sure you want to clear the entire playlist? This action cannot be undone.';
            deleteType = 'clear';
            showModal(confirmationDialog);

            // Override confirm action
            const originalConfirm = dialogConfirm.onclick;
            dialogConfirm.onclick = () => {
                clearPlaylist();
                hideModal(confirmationDialog);
                dialogConfirm.onclick = originalConfirm;
            };
        }

        // Clear playlist
        function clearPlaylist() {
            // Animate all items out
            const items = document.querySelectorAll('.playlist-item');
            items.forEach((item, index) => {
                item.style.animationDelay = `${index * 0.1}s`;
                item.classList.add('slide-out-right');
            });

            setTimeout(() => {
                // Clear music data
                musicData = [];

                // Reset player
                resetPlayer();

                // Re-render playlist
                renderPlaylist();
                updatePlaylistStats();

                showToast('Playlist cleared', 'success');
            }, items.length * 100);
        }

        // Reset player (when playlist is empty)
        function resetPlayer() {
            currentTrackIndex = 0;
            isPlaying = false;
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            progress.style.width = '0%';
            currentTimeEl.textContent = '0:00';
            playPauseIcon.className = 'fas fa-play';
            albumArt.classList.remove('playing');

            // Reset album art and song info
            albumArt.src = 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80';
            songTitle.textContent = 'No Song Selected';
            songArtist.textContent = 'Add songs to your playlist';
            songAlbum.textContent = 'Harmony Player';

            // Clear tags
            const tagsContainer = document.querySelector('.song-tags');
            tagsContainer.innerHTML = '';
        }

        // Show playlist delete options
        function showPlaylistDeleteOptions() {
            if (playlists.length === 0) {
                showToast('No playlists to delete', 'warning');
                return;
            }

            // In a real app, you'd show a modal with playlist list
            // For now, just show a toast
            showToast(`You have ${playlists.length} playlists. Select one to delete.`, 'info');
        }

        // Import playlist (demo)
        function importPlaylist() {
            showToast('Import playlist feature coming soon!', 'info');
        }

        // Export playlist (demo)
        function exportPlaylist() {
            if (musicData.length === 0) {
                showToast('Playlist is empty', 'warning');
                return;
            }

            // Create export data
            const exportData = {
                name: "My Harmony Playlist",
                description: "Exported from Harmony Player",
                exportDate: new Date().toISOString(),
                songs: musicData.map(song => ({
                    title: song.title,
                    artist: song.artist,
                    album: song.album,
                    duration: song.duration
                }))
            };

            // Create download link
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);

            const link = document.createElement('a');
            link.href = url;
            link.download = 'harmony-playlist.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showToast('Playlist exported successfully!', 'success');
        }

        // Show sleep timer options
        function showSleepTimerOptions() {
            const minutes = [5, 15, 30, 45, 60, 90];
            let message = "Set sleep timer:\n";
            minutes.forEach(min => {
                message += `\n${min} minutes`;
            });

            // In a real app, you'd show a modal
            // For now, just set a random timer
            const randomMinutes = minutes[Math.floor(Math.random() * minutes.length)];
            setSleepTimer(randomMinutes);
        }

        // Set sleep timer
        function setSleepTimer(minutes) {
            // Clear existing timer
            if (sleepTimer) {
                clearTimeout(sleepTimer);
            }

            // Set new timer
            sleepTimer = setTimeout(() => {
                pauseTrack();
                showToast(`Sleep timer: Playback stopped after ${minutes} minutes`, 'success');
            }, minutes * 60 * 1000);

            showToast(`Sleep timer set for ${minutes} minutes`, 'success');
        }

        // Download current song (demo)
        function downloadCurrentSong() {
            const track = musicData[currentTrackIndex];
            showToast(`Downloading "${track.title}"...`, 'info');

            // Simulate download
            setTimeout(() => {
                showToast(`"${track.title}" downloaded successfully!`, 'success');
            }, 1500);
        }

        // Share current song (demo)
        function shareCurrentSong() {
            const track = musicData[currentTrackIndex];

            if (navigator.share) {
                navigator.share({
                    title: track.title,
                    text: `Check out "${track.title}" by ${track.artist} on Harmony Player`,
                    url: window.location.href
                });
            } else {
                // Fallback for browsers that don't support Web Share API
                navigator.clipboard.writeText(`${track.title} by ${track.artist} - Listen on Harmony Player`);
                showToast('Song link copied to clipboard!', 'success');
            }
        }

        // Toggle fullscreen
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
                fullScreenBtn.innerHTML = '<i class="fas fa-compress"></i> Exit Fullscreen';
                showToast('Fullscreen mode activated', 'success');
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    fullScreenBtn.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
                    showToast('Fullscreen mode deactivated', 'info');
                }
            }
        }

        // Filter playlist
        function filterPlaylist() {
            const searchTerm = playlistSearch.value.toLowerCase();
            const playlistItems = document.querySelectorAll('.playlist-item');

            playlistItems.forEach(item => {
                const title = item.querySelector('.playlist-song-title').textContent.toLowerCase();
                const artist = item.querySelector('.playlist-song-artist').textContent.toLowerCase();

                if (title.includes(searchTerm) || artist.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Update play count
        function updatePlayCount() {
            const track = musicData[currentTrackIndex];
            track.playCount = (track.playCount || 0) + 1;

            // Update playlist item
            const playlistItems = document.querySelectorAll('.playlist-item');
            if (playlistItems[currentTrackIndex]) {
                const playCountElement = playlistItems[currentTrackIndex].querySelector('.play-count');
                if (playCountElement) {
                    playCountElement.textContent = track.playCount;
                    playCountElement.classList.add('animated', 'bounce-in');
                    setTimeout(() => {
                        playCountElement.classList.remove('animated', 'bounce-in');
                    }, 600);
                } else {
                    const titleElement = playlistItems[currentTrackIndex].querySelector('.playlist-song-title');
                    titleElement.innerHTML += ` <span class="play-count animated bounce-in">${track.playCount}</span>`;
                }
            }

            // Update total plays
            const totalPlays = musicData.reduce((sum, track) => sum + (track.playCount || 0), 0);
            totalPlaysEl.textContent = `${totalPlays} plays`;

            saveToLocalStorage();
        }

        // Update total play time
        function updateTotalPlayTime() {
            const hours = Math.floor(totalPlayTime / 3600);
            const minutes = Math.floor((totalPlayTime % 3600) / 60);
            const seconds = totalPlayTime % 60;

            if (hours > 0) {
                currentPlaytimeEl.textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            } else {
                currentPlaytimeEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Update playlist statistics
        function updatePlaylistStats() {
            // Update song count
            totalSongsEl.textContent = `${musicData.length} ${musicData.length === 1 ? 'song' : 'songs'}`;

            // Calculate total duration
            let totalSeconds = 0;
            musicData.forEach(song => {
                const [min, sec] = song.duration.split(':').map(Number);
                totalSeconds += min * 60 + sec;
            });

            const totalMinutes = Math.floor(totalSeconds / 60);
            const remainingSeconds = totalSeconds % 60;
            totalDurationEl.textContent = `${totalMinutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;

            // Update total plays
            const totalPlays = musicData.reduce((sum, track) => sum + (track.playCount || 0), 0);
            totalPlaysEl.textContent = `${totalPlays} plays`;
        }

        // Show modal
        function showModal(modal) {
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Hide modal
        function hideModal(modal) {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;

            // Set icon based on type
            const toastIcon = toast.querySelector('.toast-icon i');
            switch (type) {
                case 'success':
                    toastIcon.className = 'fas fa-check-circle';
                    break;
                case 'error':
                    toastIcon.className = 'fas fa-exclamation-circle';
                    break;
                case 'warning':
                    toastIcon.className = 'fas fa-exclamation-triangle';
                    break;
                default:
                    toastIcon.className = 'fas fa-info-circle';
            }

            toast.classList.add('show');

            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Format time (seconds to mm:ss)
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);

            this.classList.add('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';

            this.classList.add('drag-over');
        }

        function handleDrop(e) {
            e.stopPropagation();
            e.preventDefault();

            if (dragSrcEl !== this) {
                // Get indices
                const fromIndex = parseInt(dragSrcEl.dataset.index);
                const toIndex = parseInt(this.dataset.index);

                // Reorder array
                const [movedItem] = musicData.splice(fromIndex, 1);
                musicData.splice(toIndex, 0, movedItem);

                // Update current track index if needed
                if (currentTrackIndex === fromIndex) {
                    currentTrackIndex = toIndex;
                } else if (currentTrackIndex > fromIndex && currentTrackIndex <= toIndex) {
                    currentTrackIndex--;
                } else if (currentTrackIndex < fromIndex && currentTrackIndex >= toIndex) {
                    currentTrackIndex++;
                }

                // Re-render playlist
                renderPlaylist();

                showToast('Playlist order updated', 'success');
            }

            this.classList.remove('drag-over');
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.playlist-item').forEach(item => {
                item.classList.remove('drag-over');
            });
        }

        // Handle keyboard shortcuts
        function handleKeyboardShortcuts(e) {
            switch (e.key) {
                case ' ':
                case 'k':
                    e.preventDefault();
                    togglePlay();
                    break;
                case 'n':
                case 'ArrowRight':
                    e.preventDefault();
                    nextTrack();
                    break;
                case 'p':
                case 'ArrowLeft':
                    e.preventDefault();
                    prevTrack();
                    break;
                case 'm':
                    e.preventDefault();
                    audioPlayer.muted = !audioPlayer.muted;
                    showToast(audioPlayer.muted ? 'Muted' : 'Unmuted', 'info');
                    break;
                case 'f':
                    e.preventDefault();
                    toggleFullScreen();
                    break;
                case 't':
                    e.preventDefault();
                    toggleTheme();
                    break;
                case 's':
                    e.preventDefault();
                    toggleShuffle();
                    break;
                case 'r':
                    e.preventDefault();
                    toggleRepeat();
                    break;
                case '+':
                case 'ArrowUp':
                    e.preventDefault();
                    audioPlayer.volume = Math.min(1, audioPlayer.volume + 0.1);
                    updateVolumeSlider();
                    updateVolumeIcon(audioPlayer.volume);
                    break;
                case '-':
                case 'ArrowDown':
                    e.preventDefault();
                    audioPlayer.volume = Math.max(0, audioPlayer.volume - 0.1);
                    updateVolumeSlider();
                    updateVolumeIcon(audioPlayer.volume);
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                case '5':
                    e.preventDefault();
                    const index = parseInt(e.key) - 1;
                    if (index < musicData.length) {
                        currentTrackIndex = index;
                        loadTrack(currentTrackIndex);
                        if (!isPlaying) togglePlay();
                    }
                    break;
                case 'a':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        document.getElementById('addSongBtn').click();
                    }
                    break;
                case 'd':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        if (musicData.length > 0 && currentTrackIndex < musicData.length) {
                            showDeleteConfirmation('song', currentTrackIndex, musicData[currentTrackIndex].title);
                        }
                    }
                    break;
            }
        }

        // Save to localStorage
        function saveToLocalStorage() {
            const playerState = {
                theme: document.body.classList.contains('light-theme') ? 'light' : 'dark',
                currentTrackIndex,
                volume: audioPlayer.volume,
                isShuffled,
                isRepeating,
                musicData,
                playlists,
                totalPlayTime
            };

            localStorage.setItem('harmonyPlayerState', JSON.stringify(playerState));
        }

        // Load from localStorage
        function loadFromLocalStorage() {
            const savedState = localStorage.getItem('harmonyPlayerState');
            if (savedState) {
                try {
                    const state = JSON.parse(savedState);

                    // Apply theme
                    if (state.theme === 'light') {
                        document.body.classList.add('light-theme');
                        themeToggle.querySelector('i').className = 'fas fa-sun';
                    }

                    // Apply volume
                    if (state.volume) {
                        audioPlayer.volume = state.volume;
                        updateVolumeSlider();
                        updateVolumeIcon(state.volume);
                    }

                    // Apply shuffle state
                    if (state.isShuffled) {
                        toggleShuffle();
                    }

                    // Apply repeat state
                    if (state.isRepeating) {
                        toggleRepeat();
                    }

                    // Apply music data
                    if (state.musicData) {
                        musicData = state.musicData;
                    }

                    // Apply playlists
                    if (state.playlists) {
                        playlists = state.playlists;
                    }

                    // Apply total play time
                    if (state.totalPlayTime) {
                        totalPlayTime = state.totalPlayTime;
                        updateTotalPlayTime();
                    }

                } catch (e) {
                    console.log("Error loading saved state:", e);
                }
            }
        }

        // Initialize the player when the page loads
        window.addEventListener('DOMContentLoaded', initPlayer);

        // Listen for fullscreen change
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                fullScreenBtn.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
            }
        });

        // Close modals when clicking outside
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                hideModal(e.target);
            }
        });

    </script>
</body>

</html>